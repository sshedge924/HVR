from pyspark.sql import *
from pyspark.sql.functions import *
from pyspark.sql.types import *
from prophecy.utils import *
from prophecy.libs import typed_lit
from pl_load_postgres_synth.config.ConfigStore import *
from pl_load_postgres_synth.functions import *

def ds_cdc_file(spark: SparkSession) -> DataFrame:
    return spark.read\
        .schema(
          StructType([
            StructField("belnr", StringType(), True), StructField("bukrs", StringType(), True), StructField("gjahr", StringType(), True), StructField("mandt", StringType(), True), StructField("duefl", StringType(), True), StructField("lotkz", StringType(), True), StructField("stjah", StringType(), True), StructField("xref2_hd", StringType(), True), StructField("blind", StringType(), True), StructField("kzkrs", StringType(), True), StructField("basw3", StringType(), True), StructField("xrueb", StringType(), True), StructField("kurst", StringType(), True), StructField("arcid", StringType(), True), StructField("xreorg", StringType(), True), StructField("stblg", StringType(), True), StructField("knumv", StringType(), True), StructField("cputm", StringType(), True), StructField("ccins", StringType(), True), StructField("blart", StringType(), True), StructField("intdate", StringType(), True), StructField("basw2", StringType(), True), StructField("xsplit", StringType(), True), StructField("ssblk", StringType(), True), StructField("rldnr", StringType(), True), StructField("xmwst", StringType(), True), StructField("glvor", StringType(), True), StructField("ldgrp", StringType(), True), StructField("kzwrs", StringType(), True), StructField("wwert", StringType(), True), StructField("curt3", StringType(), True), StructField("bvorg", StringType(), True), StructField("brnch", StringType(), True), StructField("ctxkrs", StringType(), True), StructField("cpudt", StringType(), True), StructField("penrc", StringType(), True), StructField("kuty3", StringType(), True), StructField("xusvr", StringType(), True), StructField("xreversal", StringType(), True), StructField("fikrs", StringType(), True), StructField("propmano", StringType(), True), StructField("reindat", StringType(), True), StructField("xblnr", StringType(), True), StructField("curt2", StringType(), True), StructField("budat", StringType(), True), StructField("xwvof", StringType(), True), StructField("kuty2", StringType(), True), StructField("kur2x", StringType(), True), StructField("dbblg", StringType(), True), StructField("awtyp", StringType(), True), StructField("kurs3", StringType(), True), StructField("ausbk", StringType(), True), StructField("offset_refer_dat", StringType(), True), StructField("psotm", StringType(), True), StructField("xsnet", StringType(), True), StructField("psobt", StringType(), True), StructField("kurs2", StringType(), True), StructField("offset_status", StringType(), True), StructField("bktxt", StringType(), True), StructField("grpid", StringType(), True), StructField("awkey", StringType(), True), StructField("stodt", StringType(), True), StructField("intform", StringType(), True), StructField("hwae3", StringType(), True), StructField("adisc", StringType(), True), StructField("hwaer", StringType(), True), StructField("psozl", StringType(), True), StructField("psosg", StringType(), True), StructField("monat", StringType(), True), StructField("sampled", StringType(), True), StructField("doccat", StringType(), True), StructField("upddt", StringType(), True), StructField("dokid", StringType(), True), StructField("hwae2", StringType(), True), StructField("tcode", StringType(), True), StructField("txkrs", StringType(), True), StructField("psoak", StringType(), True), StructField("psodt", StringType(), True), StructField("waers", StringType(), True), StructField("xblnr_alt", StringType(), True), StructField("xref1_hd", StringType(), True), StructField("awsys", StringType(), True), StructField("kursf", StringType(), True), StructField("resubmission", StringType(), True), StructField("kursx", StringType(), True), StructField("vatdate", StringType(), True), StructField("batch", StringType(), True), StructField("follow_on", StringType(), True), StructField("iblar", StringType(), True), StructField("bstat", StringType(), True), StructField("fm_umart", StringType(), True), StructField("stgrd", StringType(), True), StructField("sname", StringType(), True), StructField("bldat", StringType(), True), StructField("cash_alloc", StringType(), True), StructField("umrd3", StringType(), True), StructField("psoks", StringType(), True), StructField("numpg", StringType(), True), StructField("frath", StringType(), True), StructField("xmca", StringType(), True), StructField("ppnam", StringType(), True), StructField("ccnum", StringType(), True), StructField("usnam", StringType(), True), StructField("xstov", StringType(), True), StructField("psofn", StringType(), True), StructField("psoty", StringType(), True), StructField("umrd2", StringType(), True), StructField("kur3x", StringType(), True), StructField("_sapf15_status", StringType(), True), StructField("xnetb", StringType(), True), StructField("exclude_flag", StringType(), True), StructField("subset", StringType(), True), StructField("aedat", StringType(), True), StructField("_fivetran_deleted", StringType(), True), StructField("_fivetran_synced", StringType(), True)
        ])
        )\
        .option("header", True)\
        .option("sep", ",")\
        .csv("dbfs:/mnt/SAPADLSMount/fivetran/bkpf1.csv")
